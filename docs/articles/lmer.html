<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Preliminary lmer models • ChickpeaAscoDispersal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Preliminary lmer models">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChickpeaAscoDispersal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Compare_Curyo_weather.html">Compare Curyo Wind with Alternate Sources</a>
    </li>
    <li>
      <a href="../articles/GAM.html">Fit Generalised Additive Models (GAMs) to the Dispersal Data</a>
    </li>
    <li>
      <a href="../articles/Import_raw_data.html">Import Raw Lesion Count Data</a>
    </li>
    <li>
      <a href="../articles/Import_weather_data.html">Weather Data Import and Cleaning</a>
    </li>
    <li>
      <a href="../articles/Visualise_data.html">Visualise Data</a>
    </li>
    <li>
      <a href="../articles/lmer.html">Preliminary lmer models</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="lmer_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Preliminary lmer models</h1>
                        <h4 class="author">P. Melloy</h4>
            
            <h4 class="date">2020-03-24</h4>
      
      
      <div class="hidden name"><code>lmer.Rmd</code></div>

    </div>

    
    
<div id="aims" class="section level2">
<h2 class="hasAnchor">
<a href="#aims" class="anchor"></a>Aims</h2>
<p>This vignette demonstrates and explains our reasoning during preliminary data analysis method. The aims of this document was to explore the conidial dispersal data and understand which factors affect the distance conidia travel during a ‘spread event’.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"lme4"</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"knitr"</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ChickpeaAscoDispersal"</span>)</span></code></pre></div>
<p>From this data we hope to interpret the following.</p>
<ul>
<li>How far conidia can be dispersed in a spread event.<br>
</li>
<li>What factors influence the dispersal distance of conidia.</li>
</ul>
<p>In this experiment there are a number of factors which may influence conidia spread. These include:<br>
* Experimental location (site).<br>
* The time at which a spread event occurred (SpEv).<br>
- The factor SpEv would be nested within site.<br>
- SpEv factor may describe variation in the data that varies between SpEv, such as weather and climate variables.<br>
* Wind speed during the spread event.<br>
* Wind direction during the spread event.<br>
* Distance the trap plants were placed from the aschochyta infested plots (distance).<br>
* The bearing in which the trap plants were placed at distances relative to the infested plots (transect).<br>
* How the spread event was initiated, with sprinkler irrigation or rainfall.<br>
* The quantity of rainfall.</p>
<p>Due to the lack of reps at some of the distances we will ignore transect as a factor. We know wind direction will influence our results and we will need to accept that adds variation for which we may not be able to account for statistically. Therefore our aim of this analysis will focus on the factors which influence the distance of conidia dispersal not direction.</p>
<p>I will start using <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer()</a></code> to analyse the mean number of lesions per plant at each distance. The reps at each distance are defined by ‘pot’, each pot contains five chickpea plants. The factor distance should be fit as a continuous variable, however because we don’t know if the relationship between mean lesions and distance from the conidia dispersal focus is linear or non-linear, we will start with distance as a categorical variable.</p>
<p>Site is a categorical variable explaining the trial location. Each site may have experienced a different number of spread events, defined by the term <code>SpEv</code>. Rainfall is required for conidia to disperse from the infected focus, and each ‘spread event’ constitutes either an overhead irrigation event or a natural rainfall event. The following table describes the replicates per site and the summary weather data for that event.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(summary_weather, <span class="dt">align =</span> <span class="st">"c"</span>, <span class="dt">caption =</span> <span class="st">"Summary weather data for replicated rain event (spread event) per unique site."</span>)</span></code></pre></div>
<table class="table">
<caption>Summary weather data for replicated rain event (spread event) per unique site.</caption>
<thead><tr class="header">
<th align="center">site</th>
<th align="center">rep</th>
<th align="center">mws</th>
<th align="center">ws_sd</th>
<th align="center">mwd</th>
<th align="center">sum_rain</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Curyo</td>
<td align="center">1</td>
<td align="center">3.577163</td>
<td align="center">2.2302100</td>
<td align="center">353.5045</td>
<td align="center">0.8</td>
</tr>
<tr class="even">
<td align="center">Horsham dryland</td>
<td align="center">1</td>
<td align="center">3.085387</td>
<td align="center">1.9379332</td>
<td align="center">311.0201</td>
<td align="center">4.6</td>
</tr>
<tr class="odd">
<td align="center">Horsham dryland</td>
<td align="center">2</td>
<td align="center">3.996127</td>
<td align="center">2.7133595</td>
<td align="center">332.3283</td>
<td align="center">18.6</td>
</tr>
<tr class="even">
<td align="center">Horsham irrigated</td>
<td align="center">1</td>
<td align="center">1.902828</td>
<td align="center">0.9050266</td>
<td align="center">234.6542</td>
<td align="center">11.0</td>
</tr>
<tr class="odd">
<td align="center">Horsham irrigated</td>
<td align="center">2</td>
<td align="center">2.233103</td>
<td align="center">1.2895001</td>
<td align="center">272.7072</td>
<td align="center">11.0</td>
</tr>
<tr class="even">
<td align="center">Horsham irrigated</td>
<td align="center">3</td>
<td align="center">6.531586</td>
<td align="center">2.1241262</td>
<td align="center">333.6699</td>
<td align="center">11.6</td>
</tr>
</tbody>
</table>
<p>The first models I will look at are asking:</p>
<ol style="list-style-type: lower-roman">
<li><p>What is the estimated mean lesions per plant as each distance from the focus, given that the conditions of each spread event is nested within each site.</p></li>
<li><p>What is the estimated mean lesions per plant as each distance from the focus, given that the conditions of each spread event is nested within each site and the distance the spore travels is dependant on the spread event at each site.</p></li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>dat &lt;-<span class="st"> </span><span class="kw">left_join</span>(lesion_counts, summary_weather, <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"site"</span>, <span class="st">"rep"</span>))</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>mod1 &lt;-</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span>(mean_pot_count <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(distance) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>site <span class="op">/</span><span class="st"> </span>SpEv),</span>
<span id="cb3-5"><a href="#cb3-5"></a>       <span class="dt">data =</span> dat)</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"mod1: "</span>)</span></code></pre></div>
<pre><code>## mod1:</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span>(mod1)</span></code></pre></div>
<pre><code>## mean_pot_count ~ as.factor(distance) + (1 | site/SpEv)</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>mod2 &lt;-</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span>(mean_pot_count <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(distance) <span class="op">+</span><span class="st"> </span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(distance) <span class="op">|</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="st">                                                 </span>site <span class="op">/</span><span class="st"> </span>SpEv),</span>
<span id="cb7-4"><a href="#cb7-4"></a>       <span class="dt">data =</span> dat)</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"mod2: "</span>)</span></code></pre></div>
<pre><code>## mod2:</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span>(mod2)</span></code></pre></div>
<pre><code>## mean_pot_count ~ as.factor(distance) + (as.factor(distance) | 
##     site/SpEv)</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Compare models</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span>(mod1, mod2)</span></code></pre></div>
<pre><code>## Warning in optwrap(optimizer, devfun, x@theta, lower = x@lower, calc.derivs =
## TRUE, : convergence code 1 from bobyqa: bobyqa -- maximum number of function
## evaluations exceeded</code></pre>
<pre><code>## Data: dat
## Models:
## mod1: mean_pot_count ~ as.factor(distance) + (1 | site/SpEv)
## mod2: mean_pot_count ~ as.factor(distance) + (as.factor(distance) | 
## mod2:     site/SpEv)
##      Df    AIC    BIC  logLik deviance Chisq Chi Df Pr(&gt;Chisq)    
## mod1  8 820.26 850.75 -402.13   804.26                            
## mod2 36 749.66 886.86 -338.83   677.66 126.6     28    1.7e-14 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>A comparison of the two models shows us that <code>mod2</code> is much better fit given the lower AIC.</p>
<p>Lets examine the results of this analysis.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(mod2)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML ['lmerMod']
## Formula: mean_pot_count ~ as.factor(distance) + (as.factor(distance) |  
##     site/SpEv)
##    Data: dat
## 
## REML criterion at convergence: 687.9
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -5.2340 -0.5760 -0.0991  0.4335  4.4464 
## 
## Random effects:
##  Groups    Name                  Variance Std.Dev. Corr                   
##  SpEv:site (Intercept)           1.6448   1.2825                          
##            as.factor(distance)10 0.6045   0.7775   -1.00                  
##            as.factor(distance)25 1.5018   1.2255   -0.98  0.98            
##            as.factor(distance)50 1.4019   1.1840   -1.00  1.00  0.97      
##            as.factor(distance)75 1.7493   1.3226   -1.00  1.00  0.98  1.00
##  site      (Intercept)           0.6695   0.8182                          
##            as.factor(distance)10 0.2307   0.4803   -1.00                  
##            as.factor(distance)25 0.4142   0.6436   -1.00  1.00            
##            as.factor(distance)50 0.4293   0.6552   -1.00  1.00  1.00      
##            as.factor(distance)75 0.6011   0.7753   -1.00  1.00  1.00  1.00
##  Residual                        0.4102   0.6405                          
## Number of obs: 334, groups:  SpEv:site, 6; site, 3
## 
## Fixed effects:
##                       Estimate Std. Error t value
## (Intercept)             2.8239     0.7209   3.917
## as.factor(distance)10  -1.5250     0.4467  -3.414
## as.factor(distance)25  -1.9704     0.6394  -3.081
## as.factor(distance)50  -2.3814     0.6333  -3.760
## as.factor(distance)75  -2.5040     0.7210  -3.473
## 
## Correlation of Fixed Effects:
##             (Intr) a.()10 a.()25 a.()50
## as.fctr()10 -0.975                     
## as.fctr()25 -0.981  0.959              
## as.fctr()50 -0.988  0.966  0.971       
## as.fctr()75 -0.993  0.968  0.977  0.984
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<p>This analysis shows there is little residual variance compared to the the variation explained by our random effects. Also we can see that the amount of variation explained by site is low. We should test that site is a significant random intercept. We can also note that as the distance increases there are less mean lesions per pot, and the variance increases.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>mod3 &lt;-</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span>(mean_pot_count <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(distance) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="st">                                  </span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(distance) <span class="op">|</span><span class="st"> </span>SpEv),</span>
<span id="cb16-4"><a href="#cb16-4"></a>       <span class="dt">data =</span> dat)</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"mod3: "</span>)</span></code></pre></div>
<pre><code>## mod3:</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span>(mod3)</span></code></pre></div>
<pre><code>## mean_pot_count ~ as.factor(distance) + (as.factor(distance) | 
##     SpEv)</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Compare models</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span>(mod2, mod3)</span></code></pre></div>
<pre><code>## Warning in optwrap(optimizer, devfun, x@theta, lower = x@lower, calc.derivs =
## TRUE, : convergence code 1 from bobyqa: bobyqa -- maximum number of function
## evaluations exceeded</code></pre>
<pre><code>## Data: dat
## Models:
## mod3: mean_pot_count ~ as.factor(distance) + (as.factor(distance) | 
## mod3:     SpEv)
## mod2: mean_pot_count ~ as.factor(distance) + (as.factor(distance) | 
## mod2:     site/SpEv)
##      Df    AIC    BIC  logLik deviance  Chisq Chi Df Pr(&gt;Chisq)
## mod3 21 720.41 800.44 -339.20   678.41                         
## mod2 36 749.66 886.86 -338.83   677.66 0.7496     15          1</code></pre>
<p>Site is not a significant factor and we can use spread event variable instead. We will use <code>mod3</code> in the following analysis. This is shown by the lower AIC for <code>mod3</code> and that the <code>site/SpEv</code> nesting is not significant on the chi-squared test of models. We should check this is consistent for when distance is a continuous variable.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># To test continous distance</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>mod4 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span>(mean_pot_count <span class="op">~</span><span class="st"> </span>distance <span class="op">+</span><span class="st"> </span>(distance <span class="op">|</span><span class="st"> </span>SpEv),</span>
<span id="cb23-3"><a href="#cb23-3"></a>             <span class="dt">data =</span> dat)</span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"mod4"</span>)</span></code></pre></div>
<pre><code>## mod4</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span>(mod4)</span></code></pre></div>
<pre><code>## mean_pot_count ~ distance + (distance | SpEv)</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># Compare models</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="kw"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span>(mod3, mod4)</span></code></pre></div>
<pre><code>## Data: dat
## Models:
## mod4: mean_pot_count ~ distance + (distance | SpEv)
## mod3: mean_pot_count ~ as.factor(distance) + (as.factor(distance) | 
## mod3:     SpEv)
##      Df    AIC    BIC  logLik deviance Chisq Chi Df Pr(&gt;Chisq)    
## mod4  6 889.71 912.58 -438.85   877.71                            
## mod3 21 720.41 800.44 -339.20   678.41 199.3     15  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p><code>mod 3</code> remains a better model compared to a model where distance is defined as continuous variable this probably relates to the non-linear relationship of <code>distance</code> and <code>mean lesions per pot</code>. For completeness lets test the nesting of <code>site</code> and <code>SpEv</code> when distance is continuous.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># To test continous distance</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>mod5 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span>(mean_pot_count <span class="op">~</span><span class="st"> </span>distance <span class="op">+</span><span class="st"> </span>(distance <span class="op">|</span><span class="st"> </span>site <span class="op">/</span><span class="st"> </span>SpEv),</span>
<span id="cb29-3"><a href="#cb29-3"></a>             <span class="dt">data =</span> dat)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"mod5"</span>)</span></code></pre></div>
<pre><code>## mod5</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span>(mod5)</span></code></pre></div>
<pre><code>## mean_pot_count ~ distance + (distance | site/SpEv)</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># Compare models</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="kw"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span>(mod4, mod5)</span></code></pre></div>
<pre><code>## refitting model(s) with ML (instead of REML)</code></pre>
<pre><code>## Data: dat
## Models:
## mod4: mean_pot_count ~ distance + (distance | SpEv)
## mod5: mean_pot_count ~ distance + (distance | site/SpEv)
##      Df    AIC    BIC  logLik deviance  Chisq Chi Df Pr(&gt;Chisq)
## mod4  6 889.71 912.58 -438.85   877.71                         
## mod5  9 895.45 929.75 -438.72   877.45 0.2606      3     0.9673</code></pre>
<p>The model comparison shows no significant difference, therefore we should proceed with the simpler model. Also the model where site is not included remains the better model because of the slightly lower AIC. Therefore we can conclude that site is not a contributing factor to the distance spores can travel.</p>
<p>Finally I want to check the fit of the model when distance is fit as a ordered categorical variable, as we know it is. In the shape of the regression is tested against polynomials for non-linear terms.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># To test continous distance</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>mod6 &lt;-</span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span>(mean_pot_count <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">ordered</a></span>(distance) <span class="op">+</span><span class="st"> </span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">ordered</a></span>(distance) <span class="op">|</span></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="st">                                               </span>SpEv),</span>
<span id="cb38-5"><a href="#cb38-5"></a>       <span class="dt">data =</span> dat)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"mod6"</span>)</span></code></pre></div>
<pre><code>## mod6</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span>(mod6)</span></code></pre></div>
<pre><code>## mean_pot_count ~ ordered(distance) + (ordered(distance) | SpEv)</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># Compare models</span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="kw"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span>(mod3, mod6)</span></code></pre></div>
<pre><code>## refitting model(s) with ML (instead of REML)</code></pre>
<pre><code>## Data: dat
## Models:
## mod3: mean_pot_count ~ as.factor(distance) + (as.factor(distance) | 
## mod3:     SpEv)
## mod6: mean_pot_count ~ ordered(distance) + (ordered(distance) | SpEv)
##      Df    AIC    BIC logLik deviance Chisq Chi Df Pr(&gt;Chisq)    
## mod3 21 720.41 800.44 -339.2   678.41                            
## mod6 21 720.41 800.44 -339.2   678.41     0      0  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>This last test shows <code>mod6</code> is a “better” model however the fit does not improve by much, because there is the same AIC. It also reinforces our suspicion that the relationship between number of lesions per pot and distance from the inoculumn focus is non-linear.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(mod6)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML ['lmerMod']
## Formula: mean_pot_count ~ ordered(distance) + (ordered(distance) | SpEv)
##    Data: dat
## 
## REML criterion at convergence: 690.8
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -5.2159 -0.5541 -0.0944  0.4294  4.4450 
## 
## Random effects:
##  Groups   Name                Variance Std.Dev. Corr                   
##  SpEv     (Intercept)         0.22915  0.4787                          
##           ordered(distance).L 1.18147  1.0870   -0.99                  
##           ordered(distance).Q 0.26892  0.5186    0.95 -0.98            
##           ordered(distance).C 0.04182  0.2045   -0.98  0.99 -0.99      
##           ordered(distance)^4 0.04361  0.2088   -0.28  0.38 -0.56  0.45
##  Residual                     0.41186  0.6418                          
## Number of obs: 334, groups:  SpEv, 6
## 
## Fixed effects:
##                     Estimate Std. Error t value
## (Intercept)           1.2038     0.1989   6.052
## ordered(distance).L  -1.9538     0.4524  -4.319
## ordered(distance).Q   0.8012     0.2266   3.536
## ordered(distance).C  -0.2747     0.1212  -2.266
## ordered(distance)^4   0.1533     0.1132   1.355
## 
## Correlation of Fixed Effects:
##             (Intr) or().L or().Q or().C
## ordrd(ds).L -0.962                     
## ordrd(ds).Q  0.882 -0.899              
## ordrd(ds).C -0.659  0.669 -0.658       
## ordrd(ds)^4 -0.233  0.281 -0.334  0.189
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<p>The fixed effects give us the mean number of lesions per plant at distance zero (intercept) and this is significantly different from zero. We can also see the mean number of lesions decreases as distance from the focus increases.</p>
<p>From here we should continue with a generalised additive model (GAM), which can handle non-linear terms better than a linear model with polynomials.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#aims">Aims</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ihsan Khaliq, Paul Melloy, Daniel Burrell, Joshua Fanning, Jean Galloway, Kevin Moore, Adam Sparks, GRDC Project USQ1903-003RTX.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
